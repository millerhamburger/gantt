# 实现 Gantt 布局 Resizer（调整器）

由于 Standard 版本中 `Resizer` 被显式定义为 `null`，我们需要重新实现一个 `Resizer` 类，并将其注册到 Gantt 的 UI 工厂中。

## 1. 定义 Resizer 类

我们需要创建一个继承自 `Cell` 的 `Resizer` 类。

**核心职责：**
1.  **渲染**：在 DOM 中渲染一个可视化的调整条。
2.  **事件监听**：监听 `mousedown` 事件以开始拖拽。
3.  **拖拽逻辑**：
    *   **onStart**: 记录鼠标起始位置和相邻单元格（表格与甘特图）的初始宽度。
    *   **onMove**: 计算偏移量，动态更新相邻单元格的宽度/高度。
    *   **onEnd**: 结束拖拽，应用最终尺寸。
4.  **方向识别**: 根据父容器的布局方向（水平 `cols` 或垂直 `rows`），自动确定是调整宽度还是高度。

## 2. 代码实现步骤

### 2.1. 查找并替换 `Resizer` 定义
在 `dhtmlxgantt.es.js` 中，找到 `const Resizer = null;` (约 17387 行)，将其替换为完整的 `Resizer` 类实现。

### 2.2. Resizer 类结构
```javascript
var Resizer = function(_super) {
    __extends(Resizer, _super);
    function Resizer(parent, config, factory, gantt) {
        var _this = _super.apply(this, arguments) || this;
        _this.$name = "resizer";
        return _this;
    }
    
    // 初始化 DOM 和事件
    Resizer.prototype.$toHTML = function() {
        // 返回带有特定 CSS 类的 HTML 字符串
    };

    Resizer.prototype.$afterToHTML = function(node) {
       // 绑定 mousedown 事件，启动全局 DnD
    };
    
    // 实现具体的拖拽逻辑
    // ...
    return Resizer;
}(Cell);
```

### 2.3. 集成 DnD (Drag and Drop)
利用 Gantt 内部现有的 DnD 服务或手动实现简单的鼠标事件监听（mousemove/mouseup）。为了保持一致性，如果能访问内部 DnD 最好，否则使用原生事件监听器实现。

**简化版实现逻辑：**
- 当用户按下 Resizer 时，在 `document.body` 上添加 `mousemove` 和 `mouseup` 监听。
- 在 `mousemove` 中计算 `delta`（鼠标位移）。
- 调整 `prev`（前一个单元格）和 `next`（后一个单元格）的尺寸。
  - 对于水平布局：`prev.width += delta`, `next.width -= delta`。
- 在 `mouseup` 中移除监听器。

## 3. 验证与测试
1.  保存修改后的文件。
2.  刷新预览页面。
3.  尝试拖拽表格和甘特图中间的分割线。
4.  确认表格宽度改变，且甘特图自适应填满剩余空间（或反之）。

## 4. 样式支持
确保 `dhtmlxgantt.css` 中有 `gantt_resizer` 类的样式（通常已有，即使 JS 中未实现），如果没有，需要添加简单的 CSS 以确保调整条可见且鼠标光标正确。

```css
.gantt_resizer {
    width: 3px;
    cursor: e-resize; /* 或 col-resize */
    background: #ececec;
    z-index: 1;
}
```
